# Property Details Display test project
## Project structure

### Backend
- Backend part is implemented using FastAPI since it's built-in Pydantic and OpenAPI support makes parsing/normalization tasks and frontend integration much easier.
- Backend part utilizes `pip` for dependency installation and `pip-tools` for potential dependency conflicts resolution, because that's one of the quickest ways to set-up the project
- API has only one endpoint which takes address as query parameter checks it against all available providers and returns list of normalized responses
- Providers integration located in `app.providers` module.
- Base network communication and authentication functionality implemented in abstract `PropertyDetailsProvider` class (`app.providers.base.PropertyDetailsProvider`)
- New providers can be added by subclassing `PropertyDetailsProvider` with `name`, `base_url` and `api_key` class properties specified. It also MUST implement `normalize` method which takes provider response data (`response.json()`) as it's single positional argument
- Normalization for both implemented providers implemented wih single Pydantic model located in `app.providers.schemas.normalized_data` module as the difference in responses are mostly structural and can be unified by specifying possible set of aliases for each field for Pydantic to lookup. The only difference is `lot_size_in_acres` field which need to be calculated for Provider1
- Any new provider should be added to `app.providers.available.AVAILABLE_PROVIDERS` tuple to be used in the endpoint

#### Things to improve
- Backend performance can be improved drastically by getting details from providers in parralel
- The backend service currently has no test coverage (0%), which needs to be addressed and improved.

### Frontend

- Frontend implemented in Typescript with React
- Project structure bootstrapped with `create-react-app` utility
- Integration with the Backend uses auto-generated client based on Backend OpenAPI spec exposed by FastAPI
- Backend client can be updated/re-generated by running `generate-client` npm script from `frontend` folder while backend service running locally
- Generated client located in `frontend/src/client` folder
- Frontend utilizes [mui](https://mui.com/) for styling
- Frontend page composed from two main components, user input and results table
- User input component located in `src/components/UserInput.tsx` file
- Results table component located in `src/components/PropertyInfo.tsx` file
- Results table rendered dynamically for all Providers in backend response. So if any providers are added or removed, no changes to the frontend are needed
- Result table rows can be added/removed by adding/removing row definitions to `tableRows` array in `[<row title>, <property name>]` format

#### Things to improve
- Result table implementation is pretty straight-forward, and because it need to be column-based instead of row-based, data trasformation step is required. It can be slow for big number of diplayed fields and/or providers. Data transformation step can be dropped entirely with more custom table implementation (but it'll require more time to implement)
- The frontend service currently has no test coverage (0%), which needs to be addressed and improved.

## Development

### Requirements
Project includes development container set-up to be used for development. To be able to use it you need:
- VS Code with [Dev Containers extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers) installed on your machine
- `Docker` installed you your machine (docker installation can vary on different platforms, please refer to official Docker documentation for [Docker Desktop](https://docs.docker.com/desktop/) or [Docker Engine](https://docs.docker.com/engine/install/))

### Start development
- Create `.env` file in `backend` folder by copying `.env.example` file and fill valid API keys for providers
- Open Project folder in `VS Code`.
- It'll detect dev container set up and show pop-up to reopen project in dev container.
- If pop-up is not displayed, you can press `Ctrl+Shift+P` (`Cmd+Shift+P` on MacOS) to open command pallete, type in "reopen" and select `Reopen in Container` option
- Wait until dev container will be built and configured (it'll automatically install required packages for both frontend and backend parts of the project)
- Add your changes to the code and run project


## Run

There are two ways to run project:
- From development container
- With `docker-compose`

### From development container
- Set up development container as described in **Development** section
- Select `Run and Debug` menu in the main sidebar
- Select `Backend` from dropdown and click `Start Debugging` button
- Select `Frontend` from dropdown and click `Start Debugging` button
- New tab with project page will be automatically opened in your default browser, or you can navigate to [http://localhost:3000](http://localhost:3000) manually

### With `docker-compose`
- In your terminal of choice navigate to project folder and run `docker compose up`
- Wait untill containers are built and navigate to [http://localhost:3000](http://localhost:3000)
